<div class="max-w-md mx-auto mt-10 p-6 border rounded shadow">
    <h2 class="text-lg font-semibold mb-4">Cambiar contraseña</h2>

    <form [formGroup]="form" (ngSubmit)="submit()">
        <div class="mb-4">
            <label for="email" class="block text-sm font-medium">Correo electrónico</label>
            <input id="email" type="email" formControlName="email" class="mt-1 w-full border rounded px-3 py-2"
                [class.border-red-500]="f.email.invalid && f.email.touched" />
            <div *ngIf="f.email.touched && f.email.errors" class="text-red-500 text-sm">
                <div *ngIf="f.email.errors['required']">El correo es obligatorio.</div>
                <div *ngIf="f.email.errors['email']">Correo no válido.</div>
            </div>
        </div>

        <div class="mb-4">
            <label for="currentPassword" class="block text-sm font-medium">Contraseña actual</label>
            <input id="currentPassword" type="password" formControlName="currentPassword"
                class="mt-1 w-full border rounded px-3 py-2"
                [class.border-red-500]="f.currentPassword.invalid && f.currentPassword.touched" />
            <div *ngIf="f.currentPassword.touched && f.currentPassword.errors" class="text-red-500 text-sm">
                <div *ngIf="f.currentPassword.errors['required']">La contraseña actual es obligatoria.</div>
            </div>
        </div>

        <div class="mb-4">
            <label for="newPassword" class="block text-sm font-medium">Nueva contraseña</label>
            <input id="newPassword" type="password" formControlName="newPassword"
                class="mt-1 w-full border rounded px-3 py-2"
                [class.border-red-500]="f.newPassword.invalid && f.newPassword.touched" />
            <div *ngIf="f.newPassword.touched && f.newPassword.errors" class="text-red-500 text-sm">
                <div *ngIf="f.newPassword.errors['required']">La nueva contraseña es obligatoria.</div>
                <div *ngIf="f.newPassword.errors['minlength']">Debe tener al menos 8 caracteres.</div>
                <div *ngIf="f.newPassword.errors['pattern']">Debe incluir mayúsculas, minúsculas, números y caracteres
                    especiales.</div>
            </div>
        </div>

        <div *ngIf="errorMessage" class="text-red-600 mb-4">{{ errorMessage }}</div>
        <div *ngIf="successMessage" class="text-green-600 mb-4">{{ successMessage }}</div>

        <button type="submit" [disabled]="form.invalid || loading"
            class="w-full bg-primary-600 text-white py-2 px-4 rounded hover:bg-primary-700">
            {{ loading ? 'Cambiando...' : 'Cambiar contraseña' }}
        </button>
    </form>
</div>