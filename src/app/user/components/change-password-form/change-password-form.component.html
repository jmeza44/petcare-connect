<div class="mx-auto mt-10 max-w-md rounded border p-6 shadow">
  <h2 class="mb-4 text-lg font-semibold">Cambiar contraseña</h2>

  <form (ngSubmit)="submit()" [formGroup]="form">
    <div class="mb-4">
      <label class="block text-sm font-medium" for="email"
        >Correo electrónico</label
      >
      <input
        [class.border-red-500]="f['email'].invalid && f['email'].touched"
        class="mt-1 w-full rounded border px-3 py-2"
        formControlName="email"
        id="email"
        type="email"
      />
      <div
        *ngIf="f['email'].touched && f['email'].errors"
        class="text-sm text-red-500"
      >
        <div *ngIf="f['email'].errors['required']">
          El correo es obligatorio.
        </div>
        <div *ngIf="f['email'].errors['email']">Correo no válido.</div>
      </div>
    </div>

    <div class="mb-4">
      <label class="block text-sm font-medium" for="currentPassword"
        >Contraseña actual</label
      >
      <input
        [class.border-red-500]="
          f['currentPassword'].invalid && f['currentPassword'].touched
        "
        class="mt-1 w-full rounded border px-3 py-2"
        formControlName="currentPassword"
        id="currentPassword"
        type="password"
      />
      <div
        *ngIf="f['currentPassword'].touched && f['currentPassword'].errors"
        class="text-sm text-red-500"
      >
        <div *ngIf="f['currentPassword'].errors['required']">
          La contraseña actual es obligatoria.
        </div>
      </div>
    </div>

    <div class="mb-4">
      <label class="block text-sm font-medium" for="newPassword"
        >Nueva contraseña</label
      >
      <input
        [class.border-red-500]="
          f['newPassword'].invalid && f['newPassword'].touched
        "
        class="mt-1 w-full rounded border px-3 py-2"
        formControlName="newPassword"
        id="newPassword"
        type="password"
      />
      <div
        *ngIf="f['newPassword'].touched && f['newPassword'].errors"
        class="text-sm text-red-500"
      >
        <div *ngIf="f['newPassword'].errors['required']">
          La nueva contraseña es obligatoria.
        </div>
        <div *ngIf="f['newPassword'].errors['minlength']">
          Debe tener al menos 8 caracteres.
        </div>
        <div *ngIf="f['newPassword'].errors['pattern']">
          Debe incluir mayúsculas, minúsculas, números y caracteres especiales.
        </div>
      </div>
    </div>

    <div *ngIf="errorMessage" class="mb-4 text-red-600">{{ errorMessage }}</div>
    <div *ngIf="successMessage" class="mb-4 text-green-600">
      {{ successMessage }}
    </div>

    <button
      [disabled]="form.invalid || loading"
      class="w-full rounded bg-primary-600 px-4 py-2 text-white hover:bg-primary-700"
      type="submit"
    >
      {{ loading ? "Cambiando..." : "Cambiar contraseña" }}
    </button>
  </form>
</div>
