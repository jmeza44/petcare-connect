<form (ngSubmit)="submit()" [formGroup]="form">
  <div class="mb-4 grid grid-cols-1 gap-4 md:grid-cols-2">
    <div class="md:col-span-2">
      <label class="block text-sm font-medium text-gray-700"
        >Contraseña actual</label
      >
      <input
        [class.border-red-500]="
          f['currentPassword'].invalid && f['currentPassword'].touched
        "
        autocomplete="current-password"
        class="mt-2 w-full rounded-md border border-gray-300 p-3 focus:ring-2 focus:ring-primary-500 focus-visible:outline-0"
        formControlName="currentPassword"
        type="password"
      />
      @if (f["currentPassword"].invalid && f["currentPassword"].touched) {
        <div class="text-sm text-red-500">
          La contraseña actual es obligatoria.
        </div>
      }
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700"
        >Nueva contraseña</label
      >
      <input
        [class.border-red-500]="
          f['newPassword'].invalid && f['newPassword'].touched
        "
        autocomplete="new-password"
        class="mt-2 w-full rounded-md border border-gray-300 p-3 focus:ring-2 focus:ring-primary-500 focus-visible:outline-0"
        formControlName="newPassword"
        type="password"
      />
      @if (f["newPassword"].invalid && f["newPassword"].touched) {
        <div class="text-sm text-red-500">
          @if (f["newPassword"].errors?.["required"]) {
            <div>La nueva contraseña es obligatoria.</div>
          }
          @if (f["newPassword"].errors?.["minlength"]) {
            <div>Debe tener al menos 8 caracteres.</div>
          }
          @if (f["newPassword"].errors?.["pattern"]) {
            <div>
              Debe incluir una mayúscula, una minúscula, un número y un carácter
              especial.
            </div>
          }
          @if (f["newPassword"].errors?.["sameAsCurrent"]) {
            <div>La nueva contraseña no puede ser igual a la actual.</div>
          }
        </div>
      }
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700"
        >Confirmar nueva contraseña</label
      >
      <input
        [class.border-red-500]="
          f['confirmPassword'].invalid && f['confirmPassword'].touched
        "
        autocomplete="new-password"
        class="mt-2 w-full rounded-md border border-gray-300 p-3 focus:ring-2 focus:ring-primary-500 focus-visible:outline-0"
        formControlName="confirmPassword"
        type="password"
      />
      @if (f["confirmPassword"].invalid && f["confirmPassword"].touched) {
        <div class="text-sm text-red-500">
          @if (f["confirmPassword"].errors?.["required"]) {
            <div>La confirmación es obligatoria.</div>
          }
          @if (f["confirmPassword"].errors?.["mismatch"]) {
            <div>Las contraseñas no coinciden.</div>
          }
        </div>
      }
    </div>
  </div>

  @if (errorMessage) {
    <div class="mb-4 text-sm text-red-500">
      {{ errorMessage }}
    </div>
  }

  <pet-button
    [customClass]="'w-full'"
    [isDisabled]="form.invalid || isLoading"
    [isLoading]="isLoading"
    color="primary"
    loadingText="Guardando..."
    size="medium"
    styling="filled"
    text="Cambiar contraseña"
    type="submit"
  ></pet-button>
</form>
