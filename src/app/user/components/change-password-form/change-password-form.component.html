<form (ngSubmit)="submit()" [formGroup]="form">
  <div class="mb-4 grid grid-cols-1 gap-4 md:grid-cols-2">
    <div class="md:col-span-2">
      <label class="block text-sm font-medium text-gray-700"
        >Contraseña actual</label
      >
      <input
        [class.border-red-500]="
          f['currentPassword'].invalid && f['currentPassword'].touched
        "
        autocomplete="current-password"
        class="mt-2 w-full rounded-md border border-gray-300 p-3 focus:ring-2 focus:ring-primary-500 focus-visible:outline-0"
        formControlName="currentPassword"
        type="password"
      />
      <div
        *ngIf="f['currentPassword']?.invalid && f['currentPassword']?.touched"
        class="text-sm text-red-500"
      >
        La contraseña actual es obligatoria.
      </div>
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700"
        >Nueva contraseña</label
      >
      <input
        [class.border-red-500]="
          f['newPassword'].invalid && f['newPassword'].touched
        "
        autocomplete="new-password"
        class="mt-2 w-full rounded-md border border-gray-300 p-3 focus:ring-2 focus:ring-primary-500 focus-visible:outline-0"
        formControlName="newPassword"
        type="password"
      />
      <div
        *ngIf="f['newPassword']?.invalid && f['newPassword']?.touched"
        class="text-sm text-red-500"
      >
        <div *ngIf="f['newPassword']?.errors?.['required']">
          La nueva contraseña es obligatoria.
        </div>
        <div *ngIf="f['newPassword']?.errors?.['minlength']">
          Debe tener al menos 8 caracteres.
        </div>
        <div *ngIf="f['newPassword']?.errors?.['pattern']">
          Debe incluir una mayúscula, una minúscula, un número y un carácter
          especial.
        </div>
        <div *ngIf="f['newPassword']?.errors?.['sameAsCurrent']">
          La nueva contraseña no puede ser igual a la actual.
        </div>
      </div>
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700"
        >Confirmar nueva contraseña</label
      >
      <input
        [class.border-red-500]="
          f['confirmPassword'].invalid && f['confirmPassword'].touched
        "
        autocomplete="new-password"
        class="mt-2 w-full rounded-md border border-gray-300 p-3 focus:ring-2 focus:ring-primary-500 focus-visible:outline-0"
        formControlName="confirmPassword"
        type="password"
      />
      <div
        *ngIf="f['confirmPassword']?.invalid && f['confirmPassword']?.touched"
        class="text-sm text-red-500"
      >
        <div *ngIf="f['confirmPassword']?.errors?.['required']">
          La confirmación es obligatoria.
        </div>
        <div *ngIf="f['confirmPassword']?.errors?.['mismatch']">
          Las contraseñas no coinciden.
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="errorMessage" class="mb-4 text-sm text-red-500">
    {{ errorMessage }}
  </div>

  <pet-button
    [customClass]="'w-full'"
    [isDisabled]="form.invalid || isLoading"
    [isLoading]="isLoading"
    color="primary"
    loadingText="Guardando..."
    size="medium"
    styling="filled"
    text="Cambiar contraseña"
    type="submit"
  ></pet-button>
</form>
